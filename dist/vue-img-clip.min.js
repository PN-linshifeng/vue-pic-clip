!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Vue-img-clip",[],e):"object"==typeof exports?exports["Vue-img-clip"]=e():t["Vue-img-clip"]=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e,i){var n=i(2);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,o);n.locals&&(t.exports=n.locals)},function(t,e,i){"use strict";var n=i(0);i.n(n).a},function(t,e,i){(t.exports=i(3)(!1)).push([t.i,"\n@font-face {\n  font-family: 'iconfont';  /* project id 953300 */\n  src: url('//at.alicdn.com/t/font_953300_clegio409me.eot');\n  src: url('//at.alicdn.com/t/font_953300_clegio409me.eot?#iefix') format('embedded-opentype'),\n  url('//at.alicdn.com/t/font_953300_clegio409me.woff') format('woff'),\n  url('//at.alicdn.com/t/font_953300_clegio409me.ttf') format('truetype'),\n  url('//at.alicdn.com/t/font_953300_clegio409me.svg#iconfont') format('svg');\n}\n.clip[data-v-29874490] {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n.clip .icon[data-v-29874490],\n.clip > input[data-v-29874490] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 10;\n}\n.clip .picture[data-v-29874490] {\n  display: -webkit-flex;\n  display: flex;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 20;\n}\n.clip .picture img[data-v-29874490] {\n  max-width: 100%;\n  max-height: 100%;\n}\n.clip > input[data-v-29874490] {\n  width: 100%;\n  opacity: 0;\n  z-index: 30;\n}\n.clip .icon[data-v-29874490] {\n  text-align: center;\n  border: 2px solid rgba(0, 0, 0, .1);\n}\n.clip .icon i[data-v-29874490] {\n  display: -webkit-flex;\n  display: flex;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  height: 100%;\n}\n.clip .icon i[data-v-29874490]:before {\n  content: \"\\E641\";\n  display: block;\n  font-size: 30px;\n  font-family: \"iconfont\";\n  line-height: 100%;\n  color: rgba(0, 0, 0, .1);\n}\n.clip .msg[data-v-29874490] {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  z-index: 30;\n  padding: 5px 20px;\n  border-radius: 5px;\n  -webkit-border-radius: 5px;\n  transform: translate(-50%, -50%);\n  -webkit-transform:  translate(-50%, -50%);\n  color: #fff;\n  text-align: center;\n  background: rgba(0, 0, 0, .7);\n}\n.rect .icon i[data-v-29874490] {\n  height: 80%;\n}\n.rect .icon i[data-v-29874490]:before {\n  content: \"\\E641\";\n  line-height: 42px;\n}\n.rect p[data-v-29874490] {\n  margin-top: -8px;\n  font-size: 12px;\n  color: #666;\n  text-align: center;\n}\n.circle .icon[data-v-29874490],\n.circle .picture[data-v-29874490] {\n  border-radius: 50%;\n  -webkit-border-radius: 50%;\n}\n.circle .picture[data-v-29874490] {\n  overflow: hidden;\n}\n.circle .icon i[data-v-29874490]:before {\n  content: \"\\E6DA\";\n  font-size: 30px;\n}\n.popup[data-v-29874490] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 20181211;\n  background: rgba(0, 0, 0, .7);\n}\n.popup .button[data-v-29874490] {\n  display: -webkit-flex;\n  display: flex;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  z-index: 20;\n  width: 100%;\n  height: 48px;\n  text-align: center;\n  background: rgba(255, 255, 255, 1);\n}\n.popup button[data-v-29874490] {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  display: inline-block;\n  width: 40%;\n  height: 38px;\n  margin: 0 5%;\n  border: 0;\n  border-radius: 5px;\n  color: #fff;\n  background: rgba(50, 135, 255, .7);\n}\n.clip-popup[data-v-29874490] {\n  background: none;\n}\n.clip-popup .clip-box[data-v-29874490],\n.clip-popup .clip-move[data-v-29874490],\n.clip-popup .popup-move[data-v-29874490] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.clip-popup .popup-move[data-v-29874490] {\n  background: rgba(0, 0, 0, .5);\n  z-index: 18;\n}\n.clip-popup .clip-box[data-v-29874490] {\n  z-index: 20;\n}\n.clip-popup .clip-view[data-v-29874490] {\n  display: block;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  outline: 1px solid rgba(50, 135, 255, 1.0);\n}\n.clip-popup .clip-move[data-v-29874490] {\n  background: rgba(255, 255, 255, .1);\n  z-index: 21;\n}\n.clip-popup .clip-info[data-v-29874490] {\n  display: block;\n  position: absolute;\n  top: -26px;\n  left: 12px;\n  width: 112px;\n  height: 25px;\n  padding: 2px 5px;\n  background: rgba(0, 0, 0, .8);\n  color: #fff;\n}\n.clip-popup .clip-line[data-v-29874490] {\n  position: absolute;\n  display: block;\n  width: 100%;\n  height: 100%;\n  z-index: 25;\n}\n.clip-popup .line-t[data-v-29874490] {\n  top: -5px;\n  height: 10px;\n}\n.clip-popup .line-r[data-v-29874490] {\n  top: 0;\n  right: -5px;\n  width: 10px;\n}\n.clip-popup .line-b[data-v-29874490] {\n  bottom: -5px;\n  height: 10px;\n}\n.clip-popup .line-l[data-v-29874490] {\n  top: 0;\n  left: -5px;\n  width: 10px;\n}\n.clip-popup .clip-point[data-v-29874490] {\n  position: absolute;\n  display: block;\n  width: 16px;\n  height: 16px;\n  z-index: 26;\n}\n.clip-popup .point-tr[data-v-29874490] {\n  top: -3px;\n  right: -3px;\n  border-top: 3px solid rgba(50, 135, 255, 1.0);\n  border-right: 3px solid rgba(50, 135, 255, 1.0);\n}\n.clip-popup .point-br[data-v-29874490] {\n  bottom: -3px;\n  right: -3px;\n  border-right: 3px solid rgba(50, 135, 255, 1.0);\n  border-bottom: 3px solid rgba(50, 135, 255, 1.0);\n}\n.clip-popup .point-tl[data-v-29874490] {\n  top: -3px;\n  left: -3px;\n  border-top: 3px solid rgba(50, 135, 255, 1.0);\n  border-left: 3px solid rgba(50, 135, 255, 1.0);\n}\n.clip-popup .point-bl[data-v-29874490] {\n  bottom: -3px;\n  left: -3px;\n  border-bottom: 3px solid rgba(50, 135, 255, 1.0);\n  border-left: 3px solid rgba(50, 135, 255, 1.0);\n}\n.clip-popup .range[data-v-29874490] {\n  display: -webkit-flex;\n  display: flex;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  position: absolute;\n  bottom: 48px;\n  left: 0;\n  z-index: 30;\n  width: 100%;\n  height: 30px;\n  padding: 0 50px;\n}\n.clip-popup .range input[type=\"range\"][data-v-29874490] {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n  flex: 1;\n  display: block;\n  margin: 0 20px;\n  height: 3px;\n  border-radius: 2px;\n  background: rgba(255, 255, 255, .8);\n  -webkit-appearance: none;\n}\n.clip-popup .range input[type=range][data-v-29874490]::-webkit-slider-thumb {\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  border: none;\n  box-shadow: 0px 0px 3px rgba(255, 255, 255, 1.0);\n  background: rgba(50, 135, 255, 1.0);\n  -webkit-appearance: none;\n}\n.clip-popup .range span[data-v-29874490] {\n  color: #fff;\n}\n/* 弹框切换放大渐变 */\n.opacity-enter-active[data-v-29874490],\n.opacity-leave-active[data-v-29874490] {\n  -webkit-transition:  all .3s;\n  transition: all .3s;\n}\n.opacity-enter[data-v-29874490],\n.opacity-leave-to[data-v-29874490] {\n  opacity: 0;\n}\n",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var o=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(a).concat([o]).join("\n")}var s;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(n[a]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(t,e,i){var n,o,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=n.apply(this,arguments)),o}),r=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,l=0,p=[],h=i(5);function u(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=a[n.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](n.parts[s]);for(;s<n.parts.length;s++)o.parts.push(b(n.parts[s],e))}else{var r=[];for(s=0;s<n.parts.length;s++)r.push(b(n.parts[s],e));a[n.id]={id:n.id,refs:1,parts:r}}}}function d(t,e){for(var i=[],n={},o=0;o<t.length;o++){var a=t[o],s=e.base?a[0]+e.base:a[0],r={css:a[1],media:a[2],sourceMap:a[3]};n[s]?n[s].parts.push(r):i.push(n[s]={id:s,parts:[r]})}return i}function f(t,e){var i=r(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=p[p.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),p.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=r(t.insertAt.before,i);i.insertBefore(e,o)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=p.indexOf(t);e>=0&&p.splice(e,1)}function m(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return v(e,t.attrs),f(t,e),e}function v(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function b(t,e){var i,n,o,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var s=l++;i=c||(c=m(e)),n=y.bind(null,i,s,!1),o=y.bind(null,i,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),f(t,e),e}(e),n=function(t,e,i){var n=i.css,o=i.sourceMap,a=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||a)&&(n=h(n));o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var s=new Blob([n],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(s),r&&URL.revokeObjectURL(r)}.bind(null,i,e),o=function(){g(i),i.href&&URL.revokeObjectURL(i.href)}):(i=m(e),n=function(t,e){var i=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),o=function(){g(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=d(t,e);return u(i,e),function(t){for(var n=[],o=0;o<i.length;o++){var s=i[o];(r=a[s.id]).refs--,n.push(r)}t&&u(d(t,e),e);for(o=0;o<n.length;o++){var r;if(0===(r=n[o]).refs){for(var c=0;c<r.parts.length;c++)r.parts[c]();delete a[r.id]}}}};var x,w=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function y(t,e,i,n){var o=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,o);else{var a=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,a=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["clip",t.theme]},[i("div",{staticClass:"icon"},[i("i",{directives:[{name:"show",rawName:"v-show",value:""===t.imgUrl,expression:"imgUrl === ''"}]}),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:""===t.imgUrl,expression:"imgUrl === ''"}]},[t._t("default")],2)]),t._v(" "),""!==t.imgUrl?i("div",{staticClass:"picture"},[i("img",{attrs:{src:t.imgUrl}})]):t._e(),t._v(" "),i("input",{ref:"uploadImg",attrs:{type:"file",accept:t.accept},on:{change:function(e){t.getImg(e)}}}),t._v(" "),i("transition",{attrs:{name:"opacity"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showPopup,expression:"showPopup"}],class:["popup",{"clip-popup":t.autoClip}]},[i("img",{ref:"image",attrs:{src:t.clipImg,alt:""}}),t._v(" "),t.autoClip?i("div",{staticClass:"popup-move",on:{mousedown:t.startMove,touchstart:function(e){return e.preventDefault(),t.startMove(e)}}}):t._e(),t._v(" "),t.autoClip?i("div",{ref:"clipBox",staticClass:"clip-box"},[i("span",{staticClass:"clip-view"},[i("img",{ref:"clipImage",attrs:{src:t.clipImg,alt:""}})]),t._v(" "),i("span",{staticClass:"clip-move",on:{mousedown:t.clipMove,touchstart:function(e){return e.preventDefault(),t.clipMove(e)}}}),t._v(" "),i("span",{staticClass:"clip-info",domProps:{textContent:t._s(t.clipSizeValue)}}),t._v(" "),t.fixedBox?t._e():i("span",[i("i",{staticClass:"clip-line line-t",on:{mousedown:function(e){t.changeClipSize(e,!1,!0,0,1)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!1,!0,0,1)}}}),t._v(" "),i("i",{staticClass:"clip-line line-r",on:{mousedown:function(e){t.changeClipSize(e,!0,!1,2,0)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!1,2,0)}}}),t._v(" "),i("i",{staticClass:"clip-line line-b",on:{mousedown:function(e){t.changeClipSize(e,!1,!0,0,2)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!1,!0,0,2)}}}),t._v(" "),i("i",{staticClass:"clip-line line-l",on:{mousedown:function(e){t.changeClipSize(e,!0,!1,1,0)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!1,1,0)}}}),t._v(" "),i("i",{staticClass:"clip-point point-tr",on:{mousedown:function(e){t.changeClipSize(e,!0,!0,2,1)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!0,2,1)}}}),t._v(" "),i("i",{staticClass:"clip-point point-br",on:{mousedown:function(e){t.changeClipSize(e,!0,!0,2,2)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!0,2,2)}}}),t._v(" "),i("i",{staticClass:"clip-point point-bl",on:{mousedown:function(e){t.changeClipSize(e,!0,!0,1,2)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!0,1,2)}}}),t._v(" "),i("i",{staticClass:"clip-point point-tl",on:{mousedown:function(e){t.changeClipSize(e,!0,!0,1,1)},touchstart:function(e){e.preventDefault(),t.changeClipSize(e,!0,!0,1,1)}}})])]):t._e(),t._v(" "),t.autoClip?i("div",{staticClass:"range"},[i("span",[t._v("0%")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.imgScaleVal,expression:"imgScaleVal"}],attrs:{type:"range",min:"0",max:"100"},domProps:{value:t.imgScaleVal},on:{input:function(e){t.imageScale(e)},__r:function(e){t.imgScaleVal=e.target.value}}}),t._v(" "),i("span",[t._v("100%")])]):t._e(),t._v(" "),i("div",{staticClass:"button"},[i("button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("button",{on:{click:t.finish}},[t._v("完成")])])])]),t._v(" "),i("transition",{attrs:{name:"opacity"}},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.msgStatus,expression:"msgStatus"}],staticClass:"msg",domProps:{textContent:t._s(t.msg)}})])],1)};n._withStripped=!0;var o=function(t,e){for(var i in e)t[i]=e[i];return t},a={name:"VueClip",data:function(){return{screenWidth:document.documentElement.clientWidth,screenHeight:document.documentElement.clientHeight-48,imgUrl:this.img,imgName:"",image:"",clipImg:"",showPopup:!1,imgScaleVal:0,moveX:0,moveY:0,clipWidth:0,clipHeight:0,clipMoveX:0,clipMoveY:0,clipOldX:0,clipOldY:0,canChangeX:!1,canChangeY:!1,changeClipTypeX:1,changeClipTypeY:1,imgSize:{x:0,y:0,w:0,h:0,s:1},boxSize:{x:0,y:0,w:0,h:0,s:1},msg:"",msgStatus:!1,msgTimer:null}},props:{accept:{type:String,default:"image/png, image/jpeg, image/jpg, image/gif"},autoClip:{type:Boolean,default:!1},autoClipWidth:{type:Number,default:0},autoClipHeight:{type:Number,default:0},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},dataUrlType:{type:String,default:"blob"},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:function(){return[1,1]}},fixedBox:{type:Boolean,default:!1},img:{type:[String,Blob,null,File],default:""},isOriginalImg:{type:Boolean,default:!1},maxWidth:{type:Number,default:600},maxHeight:{type:Number,default:600},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},theme:{type:String,default:"rect"}},computed:{clipSizeValue:function(){var t=0===this.boxSize.w?(.8*this.screenWidth).toFixed(0):this.boxSize.w,e=0===this.boxSize.h?(.8*this.screenWidth).toFixed(0):this.boxSize.h;return"".concat(t," x ").concat(e,"  ").concat(this.imgScaleVal,"%")},pictureType:function(){return this.accept.split(",").map(function(t){return t.split("/")[1]})}},methods:{filetoDataURL:function(t,e){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsDataURL(t)},dataURLtoImage:function(t){return new Promise(function(e){var i=new Image;i.onload=function(){e(i)},i.src=t})},canvasResizetoFile:function(t,e){t.toBlob(function(t){e(t)},"image/".concat(this.outputType),this.outputSize)},canvasResizetoDataURL:function(t){return t.toDataURL("image/".concat(this.outputType),this.outputSize)},imagetoCanvas:function(t,e,i,n,o,a,s){var r=document.createElement("canvas"),c=r.getContext("2d"),l=a||t.width,p=s||t.height;return r.width=l,r.height=p,c.drawImage(t,e,i,n,o,0,0,l,p),r},getImg:function(t){var e=this,i=t.target.files||t.dataTransfer.files;if(0===i.length)return!1;var n=i[0];if(this.imgName=n.name,!/\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(t.target.value))return this.msg="图片类型必须是".concat(this.pictureType.join("、"),"中的一种"),this.msgStatus=!0,clearTimeout(this.msgTimer),this.msgTimer=setTimeout(function(){e.msgStatus=!1,clearTimeout(e.msgTimer)},1500),!1;n&&this.fileToPreviewImage(n)},fileToPreviewImage:function(t){var e=this;this.filetoDataURL(t,function(t){e.isRotate(t).then(function(t){e.clipImg=t,e.dataURLtoImage(t).then(function(t){e.image=t;var i=e.resizeSizeImg(t,e.screenWidth,e.screenHeight);o(e.imgSize,i),e.$nextTick(function(){e.imgScaleVal=(100*e.imgSize.s).toFixed(0),e.toClipPopup(t),e.showPopup=!0})})})})},isRotate:function(t){var e=this;return new Promise(function(i){var n=e.getOrientation(t)||1;n&&1!==n?e.dataURLtoImage(t).then(function(t){var o=document.createElement("canvas"),a=o.getContext("2d"),s=0,r=0;switch(a.save(),n){case 3:o.width=t.width,o.height=t.height,a.rotate(Math.PI),s=-t.width,r=-t.height;break;case 6:o.width=t.height,o.height=t.width,a.rotate(90*Math.PI/180),r=-t.height;break;case 8:o.width=t.height,o.height=t.width,a.rotate(-90*Math.PI/180),s=-t.width;break;default:o.width=t.width,o.height=t.height}a.drawImage(t,s,r),a.restore(),i(e.canvasResizetoDataURL(o))}):i(t)})},base64ToArrayBuffer:function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),i=e.length,n=new ArrayBuffer(i),o=new Uint8Array(n),a=0;a<i;a++)o[a]=e.charCodeAt(a);return n},getStringFromCharCode:function(t,e,i){var n,o="";for(n=e,i+=e;n<i;n++)o+=String.fromCharCode(t.getUint8(n));return o},getOrientation:function(t){var e,i,n,o,a,s,r,c,l,p,h=this.base64ToArrayBuffer(t),u=new DataView(h),d=u.byteLength;if(255===u.getUint8(0)&&216===u.getUint8(1))for(l=2;l<d;){if(255===u.getUint8(l)&&225===u.getUint8(l+1)){r=l;break}l++}if(r&&(i=r+4,n=r+10,"Exif"===this.getStringFromCharCode(u,i,4)&&((a=18761===(s=u.getUint16(n)))||19789===s)&&42===u.getUint16(n+2,a)&&(o=u.getUint32(n+4,a))>=8&&(c=n+o)),c)for(d=u.getUint16(c,a),p=0;p<d;p++)if(l=c+12*p+2,274===u.getUint16(l,a)){l+=8,e=u.getUint16(l,a);break}return e},cancel:function(){this.showPopup=!1,this.$refs.uploadImg.value=""},finish:function(){var t=this,e=null;if(this.autoClip)e=this.imagetoCanvas(this.image,(this.boxSize.x-this.imgSize.x-this.image.width*(1-this.imgSize.s)/2)/this.imgSize.s,(this.boxSize.y-this.imgSize.y-this.image.height*(1-this.imgSize.s)/2)/this.imgSize.s,this.boxSize.w/this.imgSize.s,this.boxSize.h/this.imgSize.s,this.boxSize.w,this.boxSize.h);else{var i=this.resizeSizeImg(this.image,this.maxWidth,this.maxHeight);e=this.imagetoCanvas(this.image,0,0,this.image.width,this.image.height,i.w,i.h)}if("blob"===this.dataUrlType)this.canvasResizetoFile(e,function(e){t.imgUrl=URL.createObjectURL(e),t.$emit("finish",t.imgName,e)});else{var n=this.canvasResizetoDataURL(e);this.imgUrl=n,this.$emit("finish",this.imgName,n)}this.$refs.uploadImg.value="",this.showPopup=!1},resizeSizeImg:function(t,e,i){var n=t.width,o=t.height,a={x:(e-n)/2,y:(i-o)/2,w:n,h:o,s:1};if(a.w<e&&a.h<i||this.isOriginalImg)return console.log(this.isOriginalImg),a;var s=parseFloat(a.w/a.h),r={x:(e-n)/2,y:(i-o)/2,w:e,h:parseInt(e/s),s:e/n},c={x:(e-n)/2,y:(i-o)/2,w:parseInt(i*s),h:i,s:i/o};return r.h<=i?r:c.w<=e?c:{x:0,y:0,w:e,h:i,s:e/n}},toClipPopup:function(t){var e=this.$refs.image;this.imgSize.w=t.width,this.imgSize.h=t.height,this.setElementStyle(e,this.imgSize),this.autoClip&&this.setClipBoxSize()},setClipBoxSize:function(){var t=this.fixedNumber[0]/this.fixedNumber[1];this.clipWidth=0===this.autoClipWidth?parseInt(.8*this.screenWidth):this.autoClipWidth,this.clipHeight=0===this.autoClipHeight?parseInt(.8*this.screenWidth/t):this.fixed?parseInt(this.autoClipWidth/t):this.autoClipHeight;var e={x:(this.screenWidth-this.clipWidth)/2,y:(this.screenHeight-this.clipHeight)/2,w:this.clipWidth,h:this.clipHeight,s:1};o(this.boxSize,e),this.clipBoxStyle()},clipBoxStyle:function(){var t=this;this.$nextTick(function(){t.setElementStyle(t.$refs.clipBox,t.boxSize),t.clipBoxImgSize()})},clipBoxImgSize:function(){var t={x:this.imgSize.x-this.boxSize.x,y:this.imgSize.y-this.boxSize.y,w:this.imgSize.w,h:this.imgSize.h,s:this.imgSize.s};this.setElementStyle(this.$refs.clipImage,t)},setElementStyle:function(t,e){t.style.width="".concat(e.w,"px"),t.style.height="".concat(e.h,"px"),t.style.transform="translate3d(".concat(e.x,"px, ").concat(e.y,"px, 0) scale(").concat(e.s,", ").concat(e.s,")")},imageScale:function(t){var e=this;this.imgSize.s=t.target.value/100,this.$nextTick(function(){var t=e.$refs.image;e.setElementStyle(t,e.imgSize),e.clipBoxStyle(e.image)})},startMove:function(t){if(t.preventDefault(),!this.canMove)return!1;var e=t.touches?t.touches[0]:t;this.moveX=this.imgSize.x-e.clientX,this.moveY=this.imgSize.y-e.clientY,window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg),window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg)},moveImg:function(t){var e=this,i=t.touches?t.touches[0]:t,n=i.clientX,o=i.clientY,a=n+this.moveX,s=o+this.moveY;this.imgSize.x=a,this.imgSize.y=s,this.$nextTick(function(){e.setElementStyle(e.$refs.image,e.imgSize),e.clipBoxImgSize()})},leaveImg:function(t){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("touchend",this.leaveImg)},clipMove:function(t){if(t.preventDefault(),!this.canMoveBox)return!1;var e=t.touches?t.touches[0]:t;this.clipMoveX=this.boxSize.x-e.clientX,this.clipMoveY=this.boxSize.y-e.clientY,this.clipWidth=this.boxSize.w,this.clipHeight=this.boxSize.h,window.addEventListener("mousemove",this.moveClip),window.addEventListener("mouseup",this.leaveClip),window.addEventListener("touchmove",this.moveClip),window.addEventListener("touchend",this.leaveClip)},moveClip:function(t){var e=t.touches?t.touches[0]:t,i=e.clientX,n=e.clientY,o=i+this.clipMoveX,a=n+this.clipMoveY;o<0?this.boxSize.x=0:o>this.screenWidth-this.clipWidth?this.boxSize.x=this.screenWidth-this.clipWidth:this.boxSize.x=o,a<25?this.boxSize.y=25:a>this.screenHeight-this.clipHeight?this.boxSize.y=this.screenHeight-this.clipHeight:this.boxSize.y=a,this.clipBoxStyle()},leaveClip:function(){window.removeEventListener("mousemove",this.moveClip),window.removeEventListener("mouseup",this.leaveClip),window.removeEventListener("touchmove",this.moveClip),window.removeEventListener("touchend",this.leaveClip)},changeClipSize:function(t,e,i,n,o){t.preventDefault(),window.addEventListener("mousemove",this.changeClipNow),window.addEventListener("mouseup",this.changeClipEnd),window.addEventListener("touchmove",this.changeClipNow),window.addEventListener("touchend",this.changeClipEnd);var a=t.touches?t.touches[0]:t;this.canChangeX=e,this.canChangeY=i,this.changeClipTypeX=n,this.changeClipTypeY=o,this.clipMoveX=a.clientX,this.clipMoveY=a.clientY,this.clipOldX=parseInt(this.boxSize.x),this.clipOldY=parseInt(this.boxSize.y),this.clipWidth=parseInt(this.boxSize.w),this.clipHeight=parseInt(this.boxSize.h),this.fixed&&e&&i&&(this.canChangeY=0)},changeClipNow:function(t){var e=t.touches?t.touches[0]:t,i=parseInt(e.clientX-this.clipMoveX),n=parseInt(e.clientY-this.clipMoveY),o=this.screenWidth,a=this.screenHeight;if(this.canChangeX)if(1===this.changeClipTypeX){var s=this.clipWidth-i,r=this.clipOldX+i;s>0?(this.boxSize.x=r>0?r:0,this.boxSize.w=r>0?s:this.clipWidth+this.clipOldX):(this.boxSize.x=this.clipWidth+this.clipOldX,this.boxSize.w=r>o?o-this.boxSize.x:Math.abs(s))}else if(2===this.changeClipTypeX){var c=this.clipWidth+i,l=this.clipOldX-Math.abs(c);c>0?(this.boxSize.x=this.clipOldX,this.boxSize.w=c+this.clipOldX>o?o-this.clipOldX:c):(this.boxSize.x=l>0?l:0,this.boxSize.w=l>0?Math.abs(c):this.clipOldX)}if(this.canChangeY)if(1===this.changeClipTypeY){var p=this.clipOldY+n,h=this.clipHeight-n;h>0?(this.boxSize.y=p>25?p:25,this.boxSize.h=p>25?h:this.clipHeight+this.clipOldY-25):(this.boxSize.y=this.clipHeight+this.clipOldY,this.boxSize.h=p>a?a-this.boxSize.y:Math.abs(h))}else if(2===this.changeClipTypeY){var u=this.clipHeight+n,d=this.clipOldY-Math.abs(u);u>0?(this.boxSize.y=this.clipOldY,this.boxSize.h=this.clipOldY+u>a?a-this.clipOldY:u):(this.boxSize.y=d>25?d:25,this.boxSize.h=d>25?Math.abs(u):this.clipOldY-25)}var f=this.fixedNumber[0]/this.fixedNumber[1];if(this.canChangeX&&this.fixed){var g=this.boxSize.w/f;g+this.clipOldY>a?(this.boxSize.h=a-this.clipOldY,this.boxSize.w=this.boxSize.h*f):this.boxSize.h=g}if(this.canChangeY&&this.fixed){var m=this.boxSize.h*f;m+this.clipOldX>o?(this.boxSize.w=o-this.clipOldX,this.boxSize.h=this.boxSize.w/f):this.boxSize.w=m}this.clipBoxStyle()},changeClipEnd:function(){window.removeEventListener("mousemove",this.changeClipNow),window.removeEventListener("mouseup",this.changeClipEnd),window.removeEventListener("touchmove",this.changeClipNow),window.removeEventListener("touchend",this.changeClipEnd)}}};i(1);var s=function(t,e,i,n,o,a,s,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),a&&(l._scopeId="data-v-"+a),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=c):o&&(c=r?function(){o.call(this,this.$root.$options.shadowRoot)}:o),c)if(l.functional){l._injectStyles=c;var p=l.render;l.render=function(t,e){return c.call(e),p(t,e)}}else{var h=l.beforeCreate;l.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:l}}(a,n,[],!1,null,"29874490",null);s.options.__file="src/vue-clip.vue";var r=s.exports;i.d(e,"VueClip",function(){return r});var c=function(t){t.component(r.name,r)};"undefiend"!=typeof window&&window.Vue&&c(window.Vue);e.default={install:c,VueClip:r,vueClip:r}}])});